<!DOCTYPE html>
<html>
<head>
  <title>Google Maps: demasiados markers en una misma coordenada espacial</title>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width">

  <!--RSS-->
  <link rel="alternate" type="application/rss+xml" title="Bruno Garcia" href="http://blog.garciaechegaray.com/feed.xml">

  <!-- Custom CSS -->
  <link rel="stylesheet" href="/css/app.css">

  <!--Favicon-->
  <link rel="shortcut icon" href="/favicon.ico" />

  <!--Modernizr-->
  <script src="http://cdnjs.cloudflare.com/ajax/libs/modernizr/2.7.0/modernizr.min.js"></script>

  <!--Google Analytics-->
  <script type="text/javascript">

    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-18260985-4']);
    _gaq.push(['_setDomainName', '.garciaechegaray.com']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();

  </script>  

</head>
<body>

  <!--Nav-->
  <div class="fixed">
    <nav class="top-bar" data-topbar>

      <ul class="title-area">
        <li class="name">
          <h1><a href="http://blog.garciaechegaray.com/">Bruno Garcia Echegaray</a></h1>
        </li>
        <li class="toggle-topbar menu-icon">
          <a href="">
            <span>Menu</span>
          </a>
        </li>
      </ul>

      <section class="top-bar-section">
        <ul class="right">
          <li class="divider"></li>
          <li><a href="http://bruno.garciaechegaray.com">Sobre mi</a></li>
          <li class="divider"></li>
          <li class="active"><a href="http://blog.garciaechegaray.com/">Blog</a></li>
          <li class="divider"></li>
          <li><a href="http://www.tuttifrescuni.com" title="Tutti Frescuni: ¿qué frutas y verduras se encuentran de temporada?" target="_blank">Pet Project</a></li>
          <li class="divider"></li>
          <li><a href="https://github.com/brunogarcia/Front-end-Wiki/wiki" title="Front-end Development Resources" target="_blank">Wiki</a></li>    
        </ul>
      </section>

    </nav>  
  </div>

  <!--Main-->
  <div class="main">
    <div class="row post-main">
	<h1>Google Maps: demasiados markers en una misma coordenada espacial</h1>
	<p class="meta">10 Nov 2014</p>

	<div class="post">
	<p><big>¿Cómo abordar el siguiente problema de interfaz de usuario?: tienes un mapa con demasiados marcadores y además muchos de ellos se encuentran en la misma coordenada espacial</big></p>

<p>Existe un artículo en <a href="https://developers.google.com/maps/">Google Map API</a> con varios plugins interesantes. El artículo se llama <a href="https://developers.google.com/maps/articles/toomanymarkers">Too Many Markers!</a> y me ha servido como punto de partida para encontrar una solución. </p>

<h2>Marker Clusterer</h2>

<p>Demasiados markers (o localizadores) en un mapa es claramente un problema de interfaz. La idea es poder agruparlos por cercanía según un criterio muy simple: nivel de zoom. 
Mientras más lejano el zoom (por debajo del nivel 13) más agrupados los tendremos. Y al contrario, si acercanos el zoom (por encima del nivel 15) podremos mostrar todos los markers a la vez, ya que a este nivel el marco de visualización nos permite una interacción correcta y fluida.</p>

<p>Entre todas las opciones, he optado por <a href="https://code.google.com/p/google-maps-utility-library-v3/">Marker Clusterer</a>, ya que hace exactamente lo que tengo en mente: agrupar los markers según el nivel de zoom. </p>

<p>Este es un ejemplo de la implementación sacado de la documemtación del plugin. Los datos se encuentran en un <a href="http://google-maps-utility-library-v3.googlecode.com/svn/trunk/markerclusterer/src/data.json">fichero JSON</a> alojado en el repositorio del plugin.</p>

<iframe width="100%" height="450" src="http://jsfiddle.net/brunogarcia/cxgwb4oh/5/embedded/result,js,html,css" allowfullscreen="allowfullscreen" frameborder="0"></iframe>

<p></p>

<p>El plugin permite añadir una serie de opciones para configurarlo a nuestro gusto. En este caso un <em>gridSize</em> de 40 y un <em>maxZoom</em> de 15. 
La primera opción especifica el tamaño de la cruadrícula que servirá para agrupar nuestros markers. O sea mientras más grande sea la cuadrícula, más markers podremos agrupar en la misma.
Puede ser un valor entre 40 y 80. 
La segunda opción establece el límite de zoom al cual el plugin puede ser visualizado. Recomendable un valor por encima de 15. Recordemos que Google Maps acepta un <a href="https://developers.google.com/maps/documentation/javascript/maxzoom">máximo de 18 para el nivel de zoom</a>.</p>

<h2>Overlapping Marker Spiderfier</h2>

<p>Este plugin de nombre tan largo y extraño nos permite agrupar aquellos markers que se encuentran en el mismo punto geográfico, o sea en la misma longitud y latitud. </p>

<p>Por ejemplo, imagina que necesitas mostrar en un mapa diferentes ofertas pertenecientes al mismo establecimiento. Si tienes, digamos, 10 ofertas por establecimiento, por defecto Google Map ubicará cada marker uno encima de otro, y sólo podremos hacer click sobre el marker que se encuentra más arriba. Resultado final: no es usable.</p>

<p><a href="https://github.com/jawj/OverlappingMarkerSpiderfier">Overlapping Marker Spiderfier</a> soluciona este problema moviendo cada marker en un radio precalculado por el mismo plugin. Visualmente verás un circulo de markers y podrás hacer click en cada uno de ellos indistintamente.</p>

<p>Este es un ejemplo de la implementación sacado de la documemtación del plugin. Los datos se generan automáticamente. La <a href="https://github.com/jawj/OverlappingMarkerSpiderfier#how-to-use">configuración</a> de este plugin es un poco compleja ya que requiere una serie de pasos muy específicos que afectan directamente al objeto instanciado de Google Maps.</p>

<iframe width="100%" height="450" src="http://jawj.github.io/OverlappingMarkerSpiderfier/demo.html"  allowfullscreen="allowfullscreen" frameborder="0"></iframe>

<p></p>

<h2>Resumen</h2>

<p>Finalmente utilizando ambos plugins en un mapa podemos combinar dos comportamientos bastante complejos a nivel de interfaz de usuario.</p>

<p>En este primer pantallazo, se puede observar como funciona Marker Clusterer en un proyecto real. En este caso agrupando 17 markers en uno solo, con una iconografía personalizada.</p>

<p><img src="http://bruno.garciaechegaray.com/blog/startclub-example-01.png" alt="image"></p>

<p>En el segundo pantallazo, se puede observar como funciona Overlapping Marker Spiderfier en un proyecto real. Al hacer click sobre un establecimiento con varias ofertas, se despliegan todos los markers permitiendo una correcta interacción con la interfaz.</p>

<p><img src="http://bruno.garciaechegaray.com/blog/startclub-example-02.png" alt="image"></p>

	</div>
</div>

  </div>

  <!--Footer-->
  <div class="row">
    <hr>
    <footer>
      <div class="small-12 columns">  
        <p>Blog desarrollado con <a href="http://jekyllrb.com">Jekyll</a> y <a href="http://foundation.zurb.com">Foundation</a>. Alojado en <a href="https://github.com/brunogarcia/brunogarcia.github.io">GitHub Pages</a>. Suscríbete al <a href="/feed.xml">RSS</a></p>
      </div>

    </footer>
  </div>

  <script src="/js/build/production.min.js"></script>
</body>
</html>
